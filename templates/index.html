<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Audio Separator Pro - Web Edition</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
</head>
<body>
    <div class="container">
        <!-- SoundCloud-style Header -->
        <header class="header">
            <div class="header-content">
                <h1><i class="fas fa-waveform-lines"></i> Audio Separator Pro</h1>
                <div class="device-info">
                    <span id="device-status">üîç Detecting...</span>
                    <button id="stopServerBtn" class="btn btn-danger" style="margin-left: 12px; padding: 6px 12px; font-size: 12px;">
                        <i class="fas fa-power-off"></i> Stop Server
                    </button>
                </div>
            </div>
        </header>

        <!-- Main Content -->
        <main class="main-content">
            <!-- File Upload Section -->
            <section class="upload-section">
                <div class="upload-area" id="uploadArea">
                    <div class="upload-content">
                        <i class="fas fa-cloud-upload-alt upload-icon"></i>
                        <h3>Drop your audio files here</h3>
                        <p>or <span class="browse-link">browse files</span></p>
                        <div class="waveform-container" style="margin-top: 16px; opacity: 0.3;">
                            <div class="waveform-bar" style="height: 15px;"></div>
                            <div class="waveform-bar" style="height: 25px;"></div>
                            <div class="waveform-bar" style="height: 20px;"></div>
                            <div class="waveform-bar" style="height: 30px;"></div>
                            <div class="waveform-bar" style="height: 18px;"></div>
                            <div class="waveform-bar" style="height: 35px;"></div>
                            <div class="waveform-bar" style="height: 22px;"></div>
                            <div class="waveform-bar" style="height: 28px;"></div>
                            <div class="waveform-bar" style="height: 16px;"></div>
                            <div class="waveform-bar" style="height: 32px;"></div>
                        </div>
                        <input type="file" id="fileInput" multiple accept=".wav,.mp3,.flac,.ogg,.m4a,.aac" hidden>
                    </div>
                </div>
                
                <div class="file-list" id="fileList" style="display: none;">
                    <h4><i class="fas fa-music"></i> Selected Files</h4>
                    <div class="files-container" id="filesContainer"></div>
                    <button class="btn btn-secondary" id="clearFiles">
                        <i class="fas fa-times"></i> Clear All
                    </button>
                </div>
            </section>

            <!-- Settings Section -->
            <section class="settings-section">
                <h3><i class="fas fa-sliders-h"></i> Processing Settings</h3>
                
                <div class="settings-grid">
                    <!-- Model Selection -->
                    <div class="setting-group">
                        <label for="modelSelect">AI Model</label>
                        <select id="modelSelect" class="form-control">
                            <option value="htdemucs">HTDemucs (Recommended)</option>
                            <option value="htdemucs_ft">HTDemucs Fine-Tuned</option>
                            <option value="htdemucs_6s">HTDemucs 6-Source</option>
                            <option value="hdemucs_mmi">HDemucs MMI (Fast)</option>
                        </select>
                        <div class="model-info" id="modelInfo">
                            <span class="quality">Quality: ‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê</span>
                            <span class="speed">Speed: ‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê</span>
                        </div>
                        <button type="button" class="btn btn-secondary" id="modelInfoBtn" style="margin-top: 8px; padding: 6px 12px; font-size: 12px;">
                            <i class="fas fa-info-circle"></i> Model Info
                        </button>
                    </div>

                    <!-- Output Format -->
                    <div class="setting-group">
                        <label for="formatSelect">Output Format</label>
                        <select id="formatSelect" class="form-control">
                            <option value="wav">WAV (Lossless)</option>
                            <option value="mp3">MP3 (Compressed)</option>
                            <option value="flac">FLAC (Lossless)</option>
                        </select>
                    </div>

                    <!-- Quality -->
                    <div class="setting-group">
                        <label for="qualitySelect">Quality</label>
                        <select id="qualitySelect" class="form-control">
                            <option value="320">320 kbps (High)</option>
                            <option value="256">256 kbps</option>
                            <option value="192">192 kbps</option>
                            <option value="128">128 kbps (Fast)</option>
                        </select>
                    </div>

                    <!-- Volume Boost -->
                    <div class="setting-group">
                        <label for="volumeSlider">Volume Boost</label>
                        <div class="slider-container">
                            <input type="range" id="volumeSlider" min="0.1" max="2.0" step="0.1" value="1.0" class="slider">
                            <span id="volumeValue">1.0x</span>
                        </div>
                    </div>
                </div>

                <!-- Advanced Options -->
                <div class="advanced-options">
                    <h4><i class="fas fa-magic"></i> Advanced Options</h4>
                    <div class="checkbox-group">
                        <label class="checkbox-label">
                            <input type="checkbox" id="noiseReduction">
                            <span class="checkmark"></span>
                            <i class="fas fa-filter"></i> Apply Noise Reduction
                        </label>
                    </div>
                </div>
            </section>

            <!-- Control Buttons -->
            <section class="controls-section">
                <div style="display: flex; gap: 16px; justify-content: center; align-items: center; flex-wrap: wrap;">
                    <button class="btn btn-primary btn-large" id="processBtn" disabled>
                        <i class="fas fa-play"></i> Start Processing
                    </button>
                    <button class="btn btn-danger" id="stopBtn" style="display: none;">
                        <i class="fas fa-stop"></i> Stop
                    </button>
                </div>
            </section>

            <!-- Progress Section -->
            <section class="progress-section" id="progressSection" style="display: none;">
                <div class="progress-info">
                    <h4><i class="fas fa-waveform-lines"></i> Processing Progress</h4>
                    <div class="status-text" id="statusText">Ready to process...</div>
                </div>
                
                <div class="progress-bars">
                    <div class="progress-item">
                        <label>Overall Progress</label>
                        <div class="progress-bar">
                            <div class="progress-fill" id="overallProgress"></div>
                            <span class="progress-text" id="overallText">0%</span>
                        </div>
                    </div>
                    
                    <div class="progress-item">
                        <label>Current File</label>
                        <div class="progress-bar">
                            <div class="progress-fill" id="fileProgress"></div>
                            <span class="progress-text" id="fileText">0%</span>
                        </div>
                    </div>
                </div>
                
                <div class="time-estimate" id="timeEstimate">
                    <i class="fas fa-clock"></i>
                    <span>Estimated time: --:--</span>
                </div>
            </section>

            <!-- Results Section -->
            <section class="results-section" id="resultsSection" style="display: none;">
                <h3><i class="fas fa-check-circle"></i> Processing Complete!</h3>
                <div class="results-info" id="resultsInfo"></div>
                
                <!-- Audio Playback Section -->
                <div class="playback-section" id="playbackSection" style="margin: 24px 0;">
                    <h4><i class="fas fa-play-circle"></i> Preview Stems</h4>
                    <div class="stems-player" id="stemsPlayer">
                        <!-- Stems will be loaded here -->
                    </div>
                </div>
                
                <div class="results-actions">
                    <button class="btn btn-success" id="downloadBtn">
                        <i class="fas fa-download"></i> Download All Stems
                    </button>
                    <button class="btn btn-secondary" id="newProcessBtn" style="margin-top: 12px;">
                        <i class="fas fa-plus"></i> Process More Files
                    </button>
                </div>
            </section>
        </main>

        <!-- Model Info Modal -->
        <div class="modal" id="modelModal">
            <div class="modal-content">
                <div class="modal-header">
                    <h3><i class="fas fa-info-circle"></i> Model Information</h3>
                    <span class="close" id="closeModal">&times;</span>
                </div>
                <div class="modal-body" id="modelModalBody">
                    <!-- Model info will be populated by JavaScript -->
                </div>
            </div>
        </div>

        
        <!-- Audio Player Modal -->
        <div class="modal" id="audioPlayerModal">
            <div class="modal-content">
                <div class="modal-header">
                    <h3><i class="fas fa-music"></i> Audio Player</h3>
                    <span class="close" id="closeAudioModal">&times;</span>
                </div>
                <div class="modal-body">
                    <div class="audio-player-container">
                        <div class="now-playing" id="nowPlaying">
                            <div class="track-info">
                                <div class="track-title" id="trackTitle">Select a track</div>
                                <div class="track-artist" id="trackArtist">Audio Separator Pro</div>
                            </div>
                        </div>
                        
                        <div class="player-controls">
                            <button class="control-btn" id="prevBtn"><i class="fas fa-step-backward"></i></button>
                            <button class="control-btn play-btn" id="playPauseBtn"><i class="fas fa-play"></i></button>
                            <button class="control-btn" id="stopPlayerBtn"><i class="fas fa-stop"></i></button>
                            <button class="control-btn" id="nextBtn"><i class="fas fa-step-forward"></i></button>
                            <button class="control-btn close-btn" id="closePlayerBtn"><i class="fas fa-times"></i></button>
                        </div>
                        
                        <div class="progress-container">
                            <span class="time-display" id="currentTime">0:00</span>
                            <div class="progress-slider">
                                <input type="range" id="progressSlider" min="0" max="100" value="0" class="slider">
                            </div>
                            <span class="time-display" id="totalTime">0:00</span>
                        </div>
                        
                        <div class="volume-container">
                            <i class="fas fa-volume-up"></i>
                            <input type="range" id="volumeControl" min="0" max="100" value="70" class="slider">
                        </div>
                        
                        <audio id="audioElement" preload="metadata"></audio>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- SoundCloud-style Footer -->
    <footer class="footer">
        <div style="text-align: center; padding: 24px; border-top: 1px solid var(--border-color); margin-top: 40px;">
            <p style="color: var(--text-muted); font-size: 12px; margin: 0;">
                &copy; 2024 Audio Separator Pro - Powered by AI | 
                <span style="color: var(--primary-color);">Made with ‚ù§Ô∏è for music creators by Dream-Pixels-Forge</span>
            </p>
        </div>
    </footer>

    <!-- Scripts -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/socket.io/4.0.1/socket.io.js"></script>
    <script src="{{ url_for('static', filename='js/app.js') }}"></script>
</body>
</html>